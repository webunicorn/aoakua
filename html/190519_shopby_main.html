<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
  
    <link rel="stylesheet" href="../css/reset.css" type="text/css">
    <link rel="stylesheet" href="../css/viewScroller.css" type="text/css">
    <style>
        .shopby { margin:20px auto; display:block; position: absolute; top:100px; right:100px;}
        .shopby polyline {
            fill:none;
            stroke:antiquewhite; 
            stroke-width:20px;
            animation: brush 1.4s ease-in-out forwards;
            stroke-dasharray:800;
            stroke-dashoffset: 800;
            /* animation-fill-mode:both; */
        }
        .shopby path {
            /* fill:none; */
            stroke:antiquewhite; 
            stroke-width:20px;
            /* animation: brush 1s ease-in-out forwards; */
            stroke-dasharray:4000;
            stroke-dashoffset: 4000;
            /* animation-fill-mode:both; */
        }
        @keyframes brush1 {
            0% { stroke-dashoffset: 1000; }
            /* 20% { stroke-dashoffset: 325; }
            80% { stroke-dashoffset: 0; } */
            100% { stroke-dashoffset:0; }
        }
        @keyframes brush {
           to{
               stroke-dashoffset: 0;
           }
        }

        @keyframes ani1 {
           to{
               opacity:0.6;
           }
        }

        @keyframes brush {
           to{
               stroke-dashoffset: 0;
           }
        }
        
        .bg {background:black; width:100%; height:1000px; position:relative;}
        .final {position:absolute; top:10px; left:30px;}
        .img1 {width:400px; height:500px; position:absolute; top:30px; left:70px; background:url('../images/bg1.jpg')no-repeat 0 0;}
        .img2 {width:200px; height:200px; position:absolute; top:160px; left:170px; background:url('../images/planet2.png')no-repeat 0 0; background-size:contain;}
        .inner {width:100%; height:1000px; overflow: hidden;}
        
        /* .cont1 {visibility: hidden; height:800px;} */
        /* .cont1.cont1_inner {background:royalblue; opacity:0; width:100%; height:100%; animation: ani1 .3s ease-in-out forwards;} */
        .cont1 {background:royalblue; opacity:0.5;}
        .cont2 {background:seagreen;}
        .cont3 {background:salmon;}
        .cont4 {visibility: hidden;}
        .fix_main {width:100%; height:800px; position:fixed; top:0; left:0; transition:all 0.8s ease-out; transition-delay: 0.3s !important;}
        .fix_main.on {top:-1000px;}
        .mainbag {position:absolute; transition-delay: 0.3s !important;}
        
   </style>
 
</head>
<body>
    <div class="fix_main">
        <div class="bg">
            <svg xmlns="http://www.w3.org/2000/svg" height="400" width="400" class="shopby" style="display:none;">
                <polyline points="0,200 0,0 200,0 200,160 60,160 0,200"/>
            </svg>
            <div class="inner" style="position:relative;">
                <div class="img1"></div>
                <svg height="100" width="100"  xmlns="http://www.w3.org/2000/svg" style="position:absolute; top: 464px; left: 125px;">
                    <polygon points="0,0 10,0 0,8" style="fill:#fff;stroke:#fff;stroke-width:1;" />
                  </svg>
                <!-- <svg width="500" height="500" xmlns="http://www.w3.org/2000/svg" class="final">
                    <path class="outlined" d="M 100 450 L 100 150 L 400 150 L 400 370 L 200 370 L 105 448" 
                    style="stroke-linecap:square; stroke-linejoin:miter; animation: brush 1.8s cubic-bezier(0.550, 0.055, 0.675, 0.190) forwards; animation-delay:0.2s; stroke-width:10px; stroke:white;  fill:none; stroke-dasharray:2000; stroke-dashoffset: 2000;"/>
                </svg>  -->

                <svg width="1400" height="800" xmlns="http://www.w3.org/2000/svg" class="final">
                    <path class="outlined" d="M 50 609 L 50 50 L 1240 50 L 1240 513 L 180 513 L 52.2 615.5" 
                    style="stroke-linecap:square; stroke-linejoin:miter; animation: brush 1.8s cubic-bezier(0.550, 0.055, 0.675, 0.190) forwards; animation-delay:0.2s; stroke-width:11px; stroke:white;  fill:none; stroke-dasharray:5000; stroke-dashoffset: 5000;"/>
                </svg> 
                <div class="img2"></div>
            </div>
        </div>
    </div>
    <div class="mainbag">

        <div vs-anchor="" class="mainview cont1">
            
           
            <!-- <svg width="200" height="200" xmlns="http://www.w3.org/2000/svg">
                <path class="outlined" d="M 0 200 V 0 H 200 V 160 H40 z " style="animation: brush 1s ease-in-out forwards; stroke-width:15px; stroke:deeppink;  fill:black; stroke-dasharray:800; stroke-dashoffset: 800;"/>
            </svg> -->
        </div>
        <div vs-anchor="2" class="mainview cont2">
            section2
        </div>
        <div vs-anchor="" class="mainview cont3">
            section3
        </div>
        <div vs-anchor="" class="mainview cont4">
            section4
        
        </div>
    </div>
    <script src="../js/jquery-3.4.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.3/TweenMax.min.js"></script>
    <script src="../js/jquery.easing.min.js"></script>
    <script src="../js/jquery.mousewheel.min.js"></script>
    <script src="../js/viewScroller.js"></script>
    <script>
        $(function(){

            // function moveBackground() {
            //     x += (lFollowX - x) * friction;
            //     y += (lFollowY - y) * friction;
                
            //     translate = 'translate(' + x + 'px, ' + y + 'px) scale(1.1)';

            //     $('.img2').css({
            //         '-webit-transform': translate,
            //         '-moz-transform': translate,
            //         'transform': translate
            //     });

                

            //     window.requestAnimationFrame(moveBackground);
            // }

            // $('.inner').on('mousemove click', function(e) {

            //     var lMouseX = Math.max(-100, Math.min(100, $('.inner').width() / 2 - e.clientX));
            //     var lMouseY = Math.max(-100, Math.min(100, $('.inner').height() / 2 - e.clientY));
            //     lFollowX = (10 * lMouseX) / 150; // 100 : 12 = lMouxeX : lFollow 나누는 수가 높을 수록 조금씩 움직여짐 
            //     lFollowY = (10 * lMouseY) / 150;

                

            // });

            // moveBackground();
            
            //move with mouse
             
           
            $(".inner").mousemove(function(e) {
                parallaxIt(e, ".img2", -100);
                parallaxIt(e, ".img1", -30);
                });

                function parallaxIt(e, target, movement) {
                var $this = $(".bg");
                var relX = e.pageX - $this.offset().left;
                var relY = e.pageY - $this.offset().top;

                TweenMax.to(target, 1, {
                    x: (relX - $this.width() / 2) / $this.width() * movement,
                    y: (relY - $this.height() / 2) / $this.height() * movement
                });
            }

            //onepage scroll
            var p_h = $('.mainview').innerHeight();
            $('.mainbag').css('top', p_h);
            var myScroll = $('.mainbag').viewScroller({
                animSpeedMainView: 600, 
                animEffectMainViewCss3: 'cubic-bezier(0.550, 0.055, 0.675, 0.200)',
                useScrollbar: false, // Use scrollbar to change views
                changeWhenAnim: false, // Change views when they are changing
                loopMainViews: false, // Change horizontal views (mainviews) in loop mode
                //loopSubViews: true	// Change vertical views (subviews) in loop mode
                afterChange: function() { // Defines own callback after views change
                  
                },
                beforeChange: function() { // Defines own callback after views change
                    var locationHash = location.hash;
                    console.log(locationHash);
                    if(locationHash == '#2'){
                        if($('.fix_main').hasClass('on')){
                            $('.fix_main').removeClass('on'); 
                        }else{
                            $('.fix_main').addClass('on');
                        }
                        if($('.fix_main').css('top') == 0){
                            console.log('fix_main');
                        };

                        $('.fix_main').addClass('on');
                    }else{
                        $('.fix_main').removeClass('on');
                    }
                },
                beforeResize: function() { // Defines own callback before browser window resize
                },
                afterResize: function() { // Defines own callback after browser window resize
                    var p_h = $('.mainview').innerHeight();
                    $('.mainbag').css('top', p_h);
                }
            });
        });
    </script>
</body>
</html>